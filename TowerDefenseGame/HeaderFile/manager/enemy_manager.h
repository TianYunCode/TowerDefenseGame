#ifndef _ENEMY_MANAGER_H_
#define _ENEMY_MANAGER_H_

#include "enemy.h"
#include "manager.h"
#include "config_manager.h"
#include "home_manager.h"
#include "slim_enemy.h"
#include "king_slim_enemy.h"
#include "skeleton_enemy.h"
#include "goblin_enemy.h"
#include "goblin_priest_enemy.h"
#include "bullet_manager.h"
#include "coin_manager.h"

#include <vector>
#include <SDL.h>

//敌人管理类
class EnemyManager : public Manager<EnemyManager>
{
	friend class Manager<EnemyManager>;

public:
	typedef vector<Enemy*> EnemyList;

public:
	void on_update(double delta);
	void on_render(SDL_Renderer* renderer);

	void spawn_enemy(EnemyType type, int idx_spawn_point); //生成敌人
	bool check_cleared();								   //判断敌人是否已经被清空

	EnemyManager::EnemyList& get_enemy_list();

protected:
	EnemyManager() = default;
	~EnemyManager();

private:
	EnemyList enemy_list; //敌人列表

private:
	void process_home_collision();									   //碰撞到房屋
	void process_bullet_collision();								   //碰撞到子弹
	void remove_invalid_enemy();									   //移除无效的敌人
	void try_spawn_coin_prop(const TwoVector& position, double ratio); //尝试产生硬币道具
};

#endif